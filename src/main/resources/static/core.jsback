<!--<div style="font-size: 10px;color: gray;">-->
					<!--<div>è¿™ä¸ªç³»ç»Ÿæ²¡å’‹æµ‹è¯•è¿‡ï¼Œå‡ºé—®é¢˜äº†æˆ‘ä¸è´Ÿè´£å•Šã€‚æ²¡æœ‰è¿›è¡Œå¯†ç éªŒè¯ï¼Œéšä¾¿è¾“å…¥éƒ½èƒ½ç™»å½•ï¼Œå¦‚æœå¯†ç é”™è¯¯åªä¼šè·å–ä¸åˆ°æˆç»©ä¿¡æ¯è€Œå·²</div>-->
					<!--<div>ä½ ä»¬æ¯æ¬¡æŸ¥æˆç»©åå°éƒ½ä¼šè§£æåŠå¤©çš„ CAS éªŒè¯ï¼ˆç”Ÿæ°”ğŸ˜ çœŸéº»çƒ¦ï¼‰ï¼Œæ‰€ä»¥èŠ±çš„æ—¶é—´å¯èƒ½ä¼šæ¯”è¾ƒé•¿ï¼Œæ²¡äº‹å¯ä»¥å»å›¾ä¹¦é¦†å†™ä¼šä½œä¸šæ¶ˆç£¨ä¸‹æ—¶é—´å†å›æ¥çœ‹çœ‹</div>-->
					<!--<div>è¿˜æœ‰ä¸€äº‹ä¸çŸ¥å½“è®²ä¸å½“è®²ï¼š-->
						<!--<a href="http://seeu.studio"> seeu.studio</a> å› ä¸ºè¥¿æŸšå·¥ä½œå®¤çš„åŸå› åªåœ¨å¯’å‡å¼€æ”¾ç»™å¤§å®¶æŸ¥è¯¢ï¼Œå¼€å­¦åä¼šå…³é—­è¯¥åŠŸèƒ½ï¼Œ-->
						<!--<a href="http://ssc.sustc.edu.cn">æ ¡å›­å†…ç½‘ ssc.sustc.edu.cn</a> æ­£å¸¸æƒ…å†µä¼šé•¿æœŸå¼€æ”¾</div>-->
					<!--<div>Bug åé¦ˆ QQ ç¾¤ï¼š <a href="https://jq.qq.com/?k=443xaaB&amp;_wv=1027">ç‚¹å‡»é“¾æ¥åŠ å…¥ç¾¤ã€SUSTå­¦ç”ŸæœåŠ¡éœ€æ±‚å»ºè®¾ã€‘541207070 </a> </div>-->
				<!--</div>-->

startwork();
function startwork() {
    var name = getCookie("username");
    var pass = getCookie("password");
    $.ajax({
        url: '/mygpa', // è·³è½¬åˆ° action
        data: {
            username: name,
            password: pass,
        },
        type: 'post',
        dataType: 'json',
        success: function (data) {
            if (data.status == 1000) {
                afterpost(data);
            } else {
                alert("è¯·ç¡®è®¤å¸å·å¯†ç å†è¯•");
            }
        },
        error: function () {
            alert("è¯·ç¡®è®¤å¸å·å¯†ç å†é‡æ–°å°è¯•");
        }
    });

//	var datas = "{ \"data\": {\"data\": [[\"CH101\",\"åŒ–å­¦åŸç†\",\"4\",\"é€šè¯†å¿…ä¿®è¯¾\",\"å¿…ä¿®\",\"97\",\"&nbsp;\"]]}}";
//	var json = JSON.parse(datas);
//	loadscore(json.data);
//	calTotalScore();
}
function afterpost(datas) {
    // var json = JSON.parse(datas);
    // alert(datas);
    var json = (datas);

    // å»æ‰ loading è¿›åº¦æ¡
    var loading = document.getElementById("loading");
    loading.innerHTML = "";
    loadscore(json.data);
    calTotalScore();
}


function setCookie(c_name, value, expiredays) {
    var exdate = new Date()
    exdate.setDate(exdate.getDate() + expiredays)
    document.cookie = c_name + "=" + escape(value) +
        ((expiredays == null) ? "" : ";expires=" + exdate.toGMTString())
}

function getCookie(c_name) {
    if (document.cookie.length > 0) {
        c_start = document.cookie.indexOf(c_name + "=")
        if (c_start != -1) {
            c_start = c_start + c_name.length + 1
            c_end = document.cookie.indexOf(";", c_start)
            if (c_end == -1) c_end = document.cookie.length
            return unescape(document.cookie.substring(c_start, c_end))
        }
    }
    return ""
}

function loadscore(data) {
    var tbody = document.getElementById("seeu");
    // title  data.title
    var titles = "[\"è¯¾ç¨‹ç¼–å·\",\"è¯¾ç¨‹åç§°\",\"å­¦åˆ†\",\"è¯¾ç¨‹ç±»åˆ«\",\"è¯¾ç¨‹æ€§è´¨\",\"æ€»æˆç»©\",\"è¯„ä»·\"]";
    titles = JSON.parse(titles);
    var tr = document.createElement("tr");
    var content = "<td></td>"; // ç¬¬ä¸€ä¸ªä¸ºç©ºä½
    for (var j = 0; j < 7; j++) {
        content += "<td>" + titles[j] + "</td>";
    }
    tr.innerHTML = content;
    tbody.appendChild(tr);
    // body  data.data
    var lines = data.data;
    for (var i = 0; i < lines.length; i++) {
        var tr = document.createElement("tr");
        tr.setAttribute("id", "line" + i);
        var content = "" + makecolor(i); // color
        content += "<td>" + lines[i][0] + "</td>";
        content += "<td>" + lines[i][1] + "</td>";
        content += "<td id=\"xff" + i + "\">" + lines[i][2] + "</td>"; // å­¦åˆ†
        content += "<td>" + lines[i][3] + "</td>";
        content += "<td>" + lines[i][4] + "</td>";
        content += "<td id=\"cjj" + i + "\">" + lines[i][5] + "</td>"; //æˆç»©
        content += "<td>" + calGPA(lines[i][5]) + "</td>"; //GPA

        tr.innerHTML = content;
        //				var tr = "<tr>" + content + "</tr>";
        tbody.appendChild(tr);
    }
    // è®°å½•æ€»å…±çš„è¡Œæ•°
    var hiddenvv = document.getElementById("totallines");
    hiddenvv.value = lines.length;
}

function makecolor(which) {
    // æ ¹æ®circleåˆ¤æ–­æ˜¯å¦æ¿€æ´»
    var color = randomColor();
    return "<td><div class=\"circle " + color + "\" id=\"circle" + which + "\" onclick=\"clickCircle(" + which + ");\"></div></td>";
}

function randomColor() {
    var rdom = Math.floor(5 * Math.random());
    switch (rdom) {
        case 0:
            return "orange-bg";
        case 1:
            return "yellow-bg";
        case 2:
            return "blue-bg";
        case 3:
            return "pink-bg";
        case 4:
            return "green-bg";
        default:
            return "pink-bg";
    }
}

function calGPA(score) {
    //				var temp = score;
    //				try {
    score = parseFloat(score);
    //					if(!score < 200) {
    //						return temp;
    //					}
    //				} catch(err) {
    //					return temp;
    //				}
    if (score >= 97) return "A+";
    if (score >= 93) return "A";
    if (score >= 90) return "A-";
    if (score >= 87) return "B+";
    if (score >= 83) return "B";
    if (score >= 80) return "B-";
    if (score >= 77) return "C+";
    if (score >= 73) return "C";
    if (score >= 70) return "C-";
    if (score >= 67) return "D+";
    if (score >= 63) return "D";
    if (score >= 60) return "D-";
    if (score >= 0) return "F";
    else return "";
}

// listener:
function clickCircle(circleid) {
    var circle = document.getElementById("circle" + circleid);
    var lineid = "line" + circleid;
    var line = document.getElementById(lineid);
    if (circle.className.toString().indexOf("white-bg") == -1) {
        // å¦‚æœæ‰“å¼€
        circle.className = "circle white-bg";
        calTotalScore();
        //					alert(circle.className.toString());
    } else {
        // å¦‚æœå·²ç»è¢«å…³äº†
        circle.className = "circle " + randomColor();
        calTotalScore();
    }
}

function calTotalScore() {
    var tbody = document.getElementById("seeu");
    var totalnum = document.getElementById("totallines").value;
    var sumxf = 0;
    var sumscore = 0;
    for (var i = 0; i < totalnum; i++) {
        // åˆ¤æ–­æ˜¯å¦é€‰ä¸­
        var circle = document.getElementById("circle" + i);
        if (circle.className.toString().indexOf("white-bg") == -1) {
            var xff = document.getElementById("xff" + i);
            var cjj = document.getElementById("cjj" + i);
            if (isNum(cjj.innerHTML)) {
                var xf = parseFloat(xff.innerHTML);
                var cj = parseFloat(cjj.innerHTML);
                // alert(typeof cj);
                sumxf += xf;
                sumscore += xf * cj;
            }
        }
    }
    if (sumxf != 0) {
        var abcdiv = document.getElementById("finalabc");
        var scorediv = document.getElementById("finalscore");
        var gpadiv = document.getElementById("finalgpa");
        var finalscore = parseFloat(sumscore) / parseFloat(sumxf);
        abcdiv.innerHTML = calGPA(finalscore);
        scorediv.innerHTML = finalscore.toFixed(2);
        var standway = (finalscore * 4 / 100.00).toFixed(2);
        gpadiv.innerHTML = standway;
    }
}

function isNum(str) {
    if (parseFloat(str) == "" + str) {
        return true;
    } else return false;
}